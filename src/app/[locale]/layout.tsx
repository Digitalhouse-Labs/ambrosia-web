import { ReactNode } from "react"
import { hasLocale, NextIntlClientProvider } from "next-intl"
import type { Metadata, Viewport } from "next"
import "./globals.css"
import { Inter } from "next/font/google"
import { routing } from "@/i18n/routing"
import { notFound } from "next/navigation"
import { setRequestLocale } from "next-intl/server"
import Header from "@/components/Header"
import { ThemeProviderNext } from "@/components/ThemeProviderNext"

export const viewport: Viewport = {
   themeColor: [
      { color: "#f4f4f5", media: "(prefers-color-scheme: light)" },
      { color: "#111111", media: "(prefers-color-scheme: dark)" },
   ],
   initialScale: 1,
   maximumScale: 5,
}

export const metadata: Metadata = {
   title: "Create Next App",
   description: "Generated by create next app",
}

const inter = Inter({
   subsets: ["latin"],
})

export function generateStaticParams() {
   return routing.locales.map((locale) => ({ locale }))
}

export default async function RootLayout({
   children,
   params,
}: Readonly<{
   children: ReactNode
   params: Promise<{ locale: string }>
}>) {
   const { locale } = await params
   if (!hasLocale(routing.locales, locale)) {
      notFound()
   }

   setRequestLocale(locale)

   return (
      <html
         suppressHydrationWarning
         lang={locale}
         className={`${inter.className} scrollbar-hidden`}
      >
         <body className="bg-background text-foreground antialiased">
            <ThemeProviderNext>
               <NextIntlClientProvider>
                  <Header />
                  {children}
               </NextIntlClientProvider>
            </ThemeProviderNext>
         </body>
      </html>
   )
}
